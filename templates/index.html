{% macro app_div(app) -%}
<div class="row">
  <div class="twelve columns ui-app">
    {% if app.setdate is not none %}
    <div class="ui-app-date">
      {{ fmt_date(app.setdate) }}
    </div>
    {% endif %}

    <div class="ui-app-name">
      {{ app.name }}
    </div>

    <div class="ui-app-links">
      <a target="_blank" rel="noopener"
         href="https://maps.google.com/maps?f=q&hl=en&q={{ app.street }},+Hamburg,+Germany">Google Maps</a><br/>
      <a target="_blank" rel="noopener"
         href="https://www.geofox.de/jsf/home.seam?INPUTSTARTTYP=H&INPUTSTARTTEXT1=Informatikum&INPUTSTARTTEXT2=Hamburg&INPUTUHRZEIT=19:00&INPUTABODERAN=2&INPUTZIELTYP=A&INPUTZIELTEXT2={{ app.city }}&INPUTDATUM=23.08.2016&INPUTZIELTEXT1={{ app.publictrans }}">HVV</a><br/>
      <a href="/calendarEntry?id={{ app.get_id() }}">iCal</a><br/>
    </div>

    <div class="ui-app-address">
      {{ app.street }} ({{ app.city }})<br/>
      {{ app.publictrans }}
    </div>


    <div style="clear: both"></div>

    <div class="ui-app-comments">
      {% for comment in app.comments %}
      <div class="ui-app-comment">
        <div class="ui-app-comment-name">
          {{ comment.uname }}:
        </div>
        <div class="ui-app-comment-text">
          {{comment.text}}
        </div>
      </div>
      {% endfor %}
    </div>

    <div class="ui-app-actions">
      {% if current_user.is_active %}
      <div class="ui-app-delete ui-app-action">
        <a href="/delete?id={{ app.get_id() }}">L&ouml;schen</a>
      </div>
      {% endif %}

      <div class="comment-mech ui-app-action">
        <a class="comment-indicator">Kommentar schreiben</a>

        <div class="comment-form">

          <form action="/comment" method="post">
            <input type="hidden" name="id" value="{{ app.get_id() }}">

            <div class="three columns">
              <label for="author">Autor</label>
              {% if current_user.is_active %}
              <input type="text" name="author" value="{{ current_user.username }}">
              {% else %}
              <input type="text" name="author">
              {% endif %}
            </div>

            <div class="three columns">
              <label for="text">Text</label>
              <input type="text" name="text">
            </div>

            <div class="three columns">
              <label for="magic">Beine?</label>
              {% if current_user.is_active %}
              <input type="text" name="magic" value="4">
              {% else %}
              <input type="text" name="magic">
              {% endif %}
            </div>

            <div class="twelve columns">
              <input class="button-primary" type="submit" value="Kommentieren">
            </div>
          </form>

        </div>
      </div>
    </div>
  </div>
</div>
{%- endmacro %}

<!DOCTYPE html>
{% autoescape true %}
<html>
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="assets/normalize.css">
  <link rel="stylesheet" href="assets/skeleton.css">
  <link rel="stylesheet" href="assets/nomaden.css">
  <title>nomaden.ofosos.org</title>

  <script type="text/javascript" src="assets/nomaden.js" defer></script>
</head>
<body>

<div class="container">

  <div class="row">
    <div class="twelve columns ui-header">

      <h1>Die aktuellen Nomaden-Termine</h1>

    </div>
  </div>
</div>


<nav class="navbar">
  <div class="container">
    <ul class="navbar-list">
      <li class="navbar-item"><a class="navbar-link" href="#aktuell">Die Termine</a></li>
      <li class="navbar-item">
        <a class="navbar-link" href="/enterPub">Neue Kneipe</a>
      </li>
      <li class="navbar-item">
        <a class="navbar-link" href="archive">Archiv</a>
      </li>
      <li class="navbar-item pull-right">
        <a class="navbar-link" href="assets/about.html">&Uuml;ber uns</a>
      </li>
    </ul>
  </div>
</nav>


<div class="container">
  <div class="row">
    <div class="twelve columns">

      <div class="logo">
        <img src="assets/camel.jpg">
      </div>


      <h2 id="aktuell">Die feststehenden Termine</h2>

      <p><strong>Hinweis:</strong> Die Links zu den Kartendiensten sind automatisch erzeugt und nicht notwendigerweise
        korrekt. Bitte Filter zwischen den Ohren einschalten!</p>

    </div>
  </div>


  {% for app in fixed_apps %}

  {{ app_div(app) }}

  {% endfor %}

  <div class="row">
    <div class="twelve columns">

      <div>
        <h2>Die Warteliste</h2>
      </div>

    </div>
  </div>

  {% for app in wait_apps %}

  {{ app_div(app) }}

  {% endfor %}

  <div class="row">

    <div class="twelve columns">

      <hr>

      <a href="/calendar">Aktuelle Termine (ICS)</a>
      <a href="/archive">Alte Termine</a>
      <a href="/enterPub">Neue Kneipe</a>

      You are: <em>{{ username }}</em> <a href="{{ loginout_url }}">{{ loginout_text }}</a>

    </div>

    <div class="twelve columns">
      Copyright &copy; 2016-2018 - Die Nomaden | <a href="assets/impressum.html">Impressum</a>
    </div>

    <div class="twelve columns">
      Github: <a href="https://github.com/nomadenorg/nomads">$Id$ $Format:%ci$ ($Format:%h$)</a>
    </div>

  </div>

</div>

</body>
</html>
{% endautoescape %}
